@model PrachiIndia.Sql.TopicMaster
@{
    ViewBag.Title = "Create";
    Layout = "~/Areas/CPanel/Views/Shared/_LayoutAdmin.cshtml";
    var chapter = (PrachiIndia.Sql.Chapter)ViewBag.Chapter;
}
@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="col-md-12 row">
        <div class="panel panel-default inprdservice">
            <div class="panel-heading inprdservicehead"><h4 class="card-title">Topic Master<span class="pull-right">@Html.ActionLink("Back to List", "Index")</span></h4></div>
            <div class="panel-body inprdservice">
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                <table class="table table-bordered">
                    <tr>
                        <td width="30%">
                            @Html.Label("Class", htmlAttributes: new { @class = "control-label" })
                        </td>
                        <td width="*">
                            @*<input type="hidden" id="ClassID" value="@chapter.tblCataLog.ClassId" /><span>@chapter.Description</span>*@
                            @Html.DropDownList("ClassID", null, htmlAttributes: new { @class = "form-control" })
                            @Html.ValidationMessageFor(model => model.ClassID, "", new { @class = "text-danger" })
                        </td>
                    </tr>
                    <tr>
                        <td>@Html.Label("Book", htmlAttributes: new { @class = "control-label" })</td>
                        <td>
                            @*<input type="hidden" id="BookID" value="@chapter.tblCataLog.Id" /><span>@chapter.tblCataLog.Title</span>*@
                            @Html.DropDownList("BookID", null, htmlAttributes: new { @class = "form-control" })
                            @Html.ValidationMessageFor(model => model.BookID, "", new { @class = "text-danger" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            @Html.Label("CHAPTER", htmlAttributes: new { @class = "control-label" })
                        </td>
                        <td>
                            @*<input type="hidden" id="CHAPTERID" value="@chapter.Id" /><span>@chapter.Title</span>*@
                            @Html.DropDownList("CHAPTERID", null, htmlAttributes: new { @class = "form-control" })
                            @Html.ValidationMessageFor(model => model.CHAPTERID, "", new { @class = "text-danger" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            @Html.LabelFor(model => model.TOPIC, htmlAttributes: new { @class = "control-label" })
                        </td>
                        <td>
                            @Html.EditorFor(model => model.TOPIC, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.TOPIC, "", new { @class = "text-danger" })
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <input type="submit" value="Create" class="btn btn-primary pull-right" />
                        </td>

                    </tr>

                </table>


                <div id="wait" style="display:none;width:69px;height:89px;border:1px solid black;position:absolute;top:50%;left:50%;padding:2px;">
                    <img src="~/Content/tinymce/skins/lightgray/img/Loader1.gif" width="64" height="64" /><br>Loading..
                </div>


            </div>
        </div>
    </div>
}

@section Scripts {
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/jqueryval")
}
<script>
    $("#ClassID").on("change", function () {
        $("#wait").css("display", "block");
        var ddlBook = $("#BookID");
        var ClassID = $("#ClassID").val();
        $.ajax({
            type: "POST",
            url: "@Url.Action("GetBookByClass", "TopicMasters",new { Area= "TestHour"})",
            data: { 'ClassID': ClassID },
            success: function (response) {
                ddlBook.empty().append('<option selected="selected">Please select</option>');
                $.each(response, function () {
                    ddlBook.append($("<option></option>").val(this['Value']).html(this['Text']));
                });
                $("#wait").css("display", "none");
            },
            failure: function (response) {
                alert(response.responseText);
                $("#wait").css("display", "none");
            },
            error: function (response) {
                alert(response.responseText);
                $("#wait").css("display", "none");
            }
        });
    })

    $("#BookID").on("change", function () {
        $("#wait").css("display", "block");
        var ddlChapter = $("#CHAPTERID");
        var BookID = $("#BookID").val();
        $.ajax({
            type: "POST",
            url: "@Url.Action("GetChapterByBook", "TopicMasters",new { Area= "TestHour"})",
            data: { 'BookId': BookID },
            success: function (response) {
                ddlChapter.empty().append('<option selected="selected">Please select</option>');
                $.each(response, function () {
                    ddlChapter.append($("<option></option>").val(this['Value']).html(this['Text']));
                });
                $("#wait").css("display", "none");
            },
            failure: function (response) {
                alert(response.responseText);
                $("#wait").css("display", "none");
            },
            error: function (response) {
                alert(response.responseText);
                $("#wait").css("display", "none");
            }
        });
    })

</script>
