@model PrachiIndia.Portal.Areas.TestHour.Models.QuestionVM
@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/CPanel/Views/Shared/_LayoutAdmin.cshtml";
}

@*<script src="~/Scripts/jquery-1.10.2.min.js"></script>*@
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
<script src="~/Scripts/bootstrap.min.js"></script>


<div class="col-md-12 row">
    <div class="panel panel-default">
        <div class="panel-heading">Question Catagory</div>
        <div class="panel-body">
            <div class="col-md-12">
                @Html.TextBoxFor(m => m.Title, new { @class = "form-control", @placeholder = "Search here" })
                <br />
                @*<img src="~/Content/Image/Loader.gif" id="loader" height="20" width="20" style="display:none" />*@

                <table class="table table-striped table-bordered">
                    <tr>
                        <th>SNO#</th>
                        <th>Title</th>
                        <th>Remarks</th>
                        <th colspan="2">Action</th>
                    </tr>
                    <tbody id="QuestionCatagoryID">

                        @if (ViewBag.QuestioCatagory != null)
                        {
                            int count = 1;
                            foreach (var item in ViewBag.QuestioCatagory)
                            {
                                <tr id="row_@item.ID">
                                    <td>@count</td>
                                    <td>@item.Title</td>
                                    <td>@item.Remarks</td>
                                    <td><a href="#" class="btn btn-success" onclick="AddEditQuestion(@item.ID)"><i class="glyphicon glyphicon-pencil"></i> </a> </td>
                                    <td><a href="#" class="btn btn-danger" onclick="ConfirmDelete(@item.ID)"><i class="glyphicon glyphicon-trash"></i> </a></td>
                                </tr>
                                count = count + 1;
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="3" style="color:red;font:bold;text-align:center"><h3> No Data Found</h3> </td>

                            </tr>
                        }
                    </tbody>
                </table>
                <a href="#" class="btn btn-primary" onclick="AddEditQuestion(0)">New</a>
                <div class="modal fade" id="myModal1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <a href="#" class="close" data-dismiss="modal">&times;</a>
                                <h3 class="modal-title">Add/Edit Question</h3>
                            </div>
                            <div class="modal-body" id="myModalBodyDiv1">

                            </div>
                        </div>

                    </div>

                </div>

                <div class="modal fade" id="myModal">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <a href="#" class="close" data-dismiss="modal">&times;</a>
                                <h3 class="modal-title">Delete Catagory</h3>
                            </div>
                            <div class="modal-body">
                                <h4>Are you sure ? You want to delete this. </h4>

                                <div style="text-align:center;display:none" id="loaderDiv">
                                    <img src="~/Content/tinymce/skins/lightgray/img/Loader1.gif" />
                                </div>

                            </div>
                            <div class="modal-footer">
                                <a href="#" class="btn btn-default" data-dismiss="modal">Cancel</a>
                                <a href="#" class="btn btn-success" onclick="DeleteTopic()">Confirm</a>
                            </div>

                        </div>

                    </div>
                    <input type="hidden" id="QuestionCatagoryID" />
                </div>
            </div>
        </div>
    </div>
</div>


<script>

    $(document).ready(function () {
        $("#Title").keyup(function () {
            var searchtext = $(this).val();
            $.ajax({
                type: "Post",
                url: "/QuestionCatagory/GetSearchRecord?SearchText=" + searchtext,
                contentType: "html",
                success: function (response) {
                    $("#QuestionCatagoryID").html(response);
                }
            })
        })
    })

    var AddEditQuestion = function (Id) {
        var url = "/QuestionCatagory/AddEditQuestionCatagory?Id=" + Id;
        $("#myModalBodyDiv1").load(url, function () {
            $("#myModal1").modal("show");
        })
    }

    var DeleteQuestion = function (Id) {
        var url = "/QuestionCatagory/DeleteQuestion?Id=" + Id;

        $.ajax({
            type: "Post",
            url: url,
            success: function (response) {
                $("#QuestionCatagoryID").html(response);
                $("#_" + Id).remove();
            }
        })
    }

    var ConfirmDelete = function (TopicID) {
        $("#QuestionCatagoryID").val(TopicID);
        $("#myModal").modal('show');

    }

    var DeleteTopic = function () {

        $("#loaderDiv").show();

        var QuestioncCatID = $("#QuestionCatagoryID").val();
        $.ajax({

            type: "POST",
            url: "/QuestionCatagory/DeleteQuestionCatagory",
            data: { ID: QuestioncCatID },
            success: function (result) {
                $("#loaderDiv").hide();
                $("#myModal").modal("hide");
                $("#row_" + QuestioncCatID).remove();
                //window.location.href = "/TopicMasters/Index";
            }

        })

    }
</script>