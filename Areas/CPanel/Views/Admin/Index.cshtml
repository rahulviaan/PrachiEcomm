@model List<PrachiIndia.Portal.Models.OrderTrackVm>
@{
    ViewBag.Title = "Index";
}
<style>
    .modals {
        display: none;
        /*position: fixed;*/
        z-index: 1000;
        top: 0;
        left: 0;
        height: 5%;
        width: 10%;
        margin-left: 350px;
        margin-top: 20%;
        margin-bottom: 30px;
        position: absolute;
        background: rgba( 255, 255, 255, .8 ) url('http://i.stack.imgur.com/FhHRx.gif') 50% 50% no-repeat;
    }

    body {
        margin-top: 20px;
    }

    footer {
        margin-bottom: 10px;
    }
</style>
<style>
    .tooltip {
        position: relative;
        display: inline-block;
        border-bottom: 1px dotted black;
    }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: black;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            position: absolute;
            z-index: 1;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
        }
</style>


<link href="~/Content/dataTables.bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/DataTables/css/jquery.dataTables.min.css" rel="stylesheet" />
<script src="~/Scripts/DataTables/jquery.dataTables.min.js"></script>
<link href="~/Content/css/bootstrap-dialog.min.css" rel="stylesheet" />
<link rel="stylesheet" href="~/dist/css/bootstrap-datepicker3.min.css" />
@*<div class="col-lg-pull-9" style="width: 76%; float: left;margin-top:-256px;margin-left: 281px;">*@


<div class="container-fluid">
    <div class="panel panel-default">
        <div class="panel-heading"><h4 style="padding: 8px 0;">Admin</h4></div>
        <div class="panel-body">
            @*<input type="button" id="btndispatch" value="dispatch" />*@
            @using (Html.BeginForm("Index", "Admin", FormMethod.Post))
            {
                foreach (var m in Model)
                {
                    <div class="col-md-12 row">
                        <div class="col-md-4">
                            <div class="input-group">
                                @Html.TextBox("fromdate", m.fromdate.ToString("MM/dd/yyyy"), new { @class = "form-control date-picker", @id = "id-date-picker-1" })
                                <span class="input-group-addon">
                                    <i class="fa fa-calendar bigger-110"></i>
                                </span>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="input-group">
                                @Html.TextBox("todate", m.todate.ToString("MM/dd/yyyy"), new { @class = "form-control date-picker", @id = "id-date-picker-2" })
                                <span class="input-group-addon">
                                    <i class="fa fa-calendar bigger-110"></i>
                                </span>

                            </div>
                        </div>
                        <div class="col-md-4">

                            @{
                                var listItems = new List<SelectListItem> {
                                                            new SelectListItem{ Text="Select Pyment Status", Value = "0",Selected=true },
                                                            new SelectListItem{ Text="Transaction successfully", Value = "2" },
                                                            new SelectListItem{ Text="Transaction failure", Value = "1" },
                                                             };
                            }
                            @Html.DropDownList("TranId", listItems, new { @class = "form-control" })

                        </div>

                        <div class="col-md-1">
                            <button type="submit" class="btn btn-success"><i class="fa fa-filter fa-1x"></i></button>
                        </div>
                    </div>
                    break;
                }
            }
            <div class="table-responsive" style="padding-top:2%">
                <table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%">
                    <thead>
                        <tr>
                            <th>S.No</th>
                            <th>Order No</th>
                            <th>Amount</th>
                            <th>Date</th>
                            <th>Payment Status</th>
                            <th>Inventory</th>
                            <th>DispatchBy</th>
                            <th>OrderStatus</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{int count = 0;}
                        @if (Model.Count > 1)
                        {
                            foreach (var m in Model)
                            {
                                <tr>
                                    <td>
                                        @*@Html.ActionLink(m.OrderId, "OrderDetail", "Admin", new { OrderId = m.OrderId }, null)*@
                                        @(count + 1)
                                    </td>
                                    <td>@Html.ActionLink(m.TransactionId, "OrderDetail", "Admin", new { OrderId = m.OrderId }, null)</td>
                                    <td><i class="fa fa-inr"></i><span>@m.price</span></td>
                                    <td>
                                        @{
                                            try
                                            {
                                                var orderDate = Convert.ToDateTime(m.date).AddMinutes(330);
                                                <span>@orderDate.ToString("dd-MM-yyyy") &nbsp; @orderDate.ToString("hh:mm tt")</span>
                                            }
                                            catch
                                            {
                                                <span>
                                                    @m.date
                                                </span>
                                            }
                                        }

                                    </td>
                                    @if (m.status)
                                    {
                                        <td><span class="label label-success" onclick="CheckBookDetail(@m.OrderId);">Transaction successfully</span></td>

                                    }
                                    else
                                    {
                                        <td><span class="label label-danger">Transaction failure</span></td>
                                    }
                                    @if (string.IsNullOrWhiteSpace(m.IsProduct))
                                    {
                                        <td><span class="label label-warning">Payment not updated</span></td>
                                    }
                                    else if (m.IsProduct.ToLower() == "false")
                                    {
                                        <td><span class="label label-warning" onclick="CheckInventory(@m.OrderId);" style="cursor:pointer">Check Inventory</span></td>
                                    }
                                    else
                                    {
                                        <td><span class="label label-info">Stock Exist</span></td>
                                    }
                                    @*@if (m.IsProduct == "true") {*@

                                    @if (m.Dispatchby != null)
                                    {
                                        <td>
                                            <span class="label label-info">
                                                @m.Dispatchby
                                                <span> @m.AWBNO</span>
                                            </span>
                                        </td>
                                    }
                                    else
                                    {
                                        if (m.status)
                                        {
                                            <td><span class="label label-info" onclick="DispatchProduct(@m.OrderId);" style="cursor:pointer">Not dispatch</span></td>
                                        }
                                        else
                                        {
                                            <td><span class="label label-info tooltip">Not dispatch</span></td>
                                        }
                                    }

                                    @if (m.IsRecive)
                                    {
                                        <td><span class="label label-info">Order receive</span></td>
                                    }
                                    else
                                    {
                                        if (m.Dispatchby != null)
                                        {
                                            <td><span class="label label-info" style="cursor:pointer" onclick="OrderRecive(@m.OrderId);">Order not receive</span></td>
                                        }
                                        else
                                        {
                                            <td><span class="label label-info">Order not receive</span></td>
                                        }
                                        count = count + 1;
                                    }
                                </tr>
                            }
                        }

                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>


@*</div>*@
@*this Part we using for Dispatch Popup Start Here By Deepak:4_01_2017*@

@Html.Partial("~/Areas/CPanel/Views/Admin/_Dispatch.cshtml", new PrachiIndia.Portal.Models.OrderTrackVm())
@*//this Part we using for Dispatch Popup End Here By Deepak:4_01_2017*@
@*this Part we using for _ReciveOrderTrack Popup Start Here By Deepak:4_01_2017*@
@Html.Partial("~/Areas/CPanel/Views/Admin/_ReciveOrderTrack.cshtml", new PrachiIndia.Portal.Models.OrderTrackUpdateVm())
@*//this Part we using for _ReciveOrderTrack Popup End Here By Deepak:4_01_2017*@
@*this Part we using for Check Product in inventory Popup Start Here By Deepak:19_01_2017*@
@Html.Partial("~/Areas/CPanel/Views/Admin/_CheckProductInventory.cshtml", new PrachiIndia.Portal.Models.OrderTrackVm())
@*this Part we using for Check Product in inventory Popup End Here By Deepak:19_01_2017*@
@section scripts{
    <script src="~/Content/js/jquery.dataTables.min.js"></script>
    <script src="~/Content/js/bootstrap-dialog.min.js"></script>
    <script src="~/Scripts/jquery.validate.min.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>
    <script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>
    <script src="~/dist/js/date-time/bootstrap-datepicker.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#example').DataTable();
        });
        function DispatchProduct(id) {
            $('#Login').modal('show');
            $("#HDNOrder").val(id);
        }
        function OrderRecive(id) {
            $('#Logins').modal('show');
            $("#HDNOrders").val(id);
        }
        function CheckInventory(id) {
            //alert(123);
            $('#Loginss').modal('show');
            $("#HDNOrdersss").val(id);
        }
        function CheckBookDetail() {
            //$('#Loginss').modal('show');
            //$("#HDNOrdersss").val(id);
        }
        $('.date-picker').datepicker({
            autoclose: true,
            todayHighlight: true
        })
        $(document).ready(function () {
            // alert("123");
            $(".navbar-right").hide();
        });
    </script>

}
